from flask import Blueprint, render_template, request, redirect

tasks_bp = Blueprint('tasks', __name__)

tasks = []

@tasks_bp.route('/tasks')
def task_list():
    return render_template('tasks.html', tasks=tasks)

@tasks_bp.route('/create', methods=['GET', 'POST'])
def create_task():
    if request.method == 'POST':
        title = request.form['title']
        description = request.form['description']
        tasks.append({'id': len(tasks)+1, 'title': title, 'description': description, 'status': 'Новая'})
        return redirect('/tasks')
    return render_template('create_task.html')

@tasks_bp.route('/edit/<int:task_id>', methods=['GET', 'POST'])
def edit_task(task_id):
    task = next((t for t in tasks if t['id'] == task_id), None)
    if not task:
        return 'Задача не найдена'
    if request.method == 'POST':
        task['title'] = request.form['title']
        task['description'] = request.form['description']
        task['status'] = request.form['status']
        return redirect('/tasks')
    return render_template('edit_task.html', task=task)

@tasks_bp.route('/delete/<int:task_id>')
def delete_task(task_id):
    global tasks
    tasks = [t for t in tasks if t['id'] != task_id]
    return redirect('/tasks')
